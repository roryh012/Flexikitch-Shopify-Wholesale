document.onreadystatechange=function(){if("complete"===document.readyState){function e(e){$(".ff-section").removeClass("ff-active"),$("#"+e).addClass("ff-active"),$("#FinanceForm").attr("data-step",e)}function t(){var e=function(e){var t=/[\x01-\x09\x0B-\x0C\x0E-\x1F]+/gi;if(t.test(e)){var a=e.replace(t," ");e=a}return e}(JSON.stringify($("#FinanceForm").serializeObject()));$("#serialInput").val(e);let t=$("#customerId").val(),a=$("#current-step").val();$.ajax({type:"POST",url:"https://flexikitch.shopifyprivate.app/save_application",dataType:"json",data:{customerId:t,step:a,formData:e},success:function(e){},error:function(e){console.error(e)}})}function a(){let e='<div class="doc-group"> <label class="d-label">Select which documents you are supplying for <span>%NAME%</span></label> <select class="docs-type" onchange="switchDocType(this)" name="doc_auth[docs][%NAME%][type]" data-owner="%NAME_SP%"> <option value="dl_mc" selected>Drivers Licence AND Medicare Card</option> <option value="kp_ub_mc">Key Pass AND Utility Bill AND Medicare Card</option> <option value="pp_ub_mc">Passport AND Utility Bill AND Medicare Card</option> </select> <div class="f-docs" id="fd-%NAME_SP%"> <label class="fd-type fd-dl" > Drivers Licence (Front): <input type="file" name="doc_auth[docs][%NAME%][dlf]" ></label><label class="fd-type fd-dl" >Drivers Licence (Back) <input type="file" name="doc_auth[docs][%NAME%][dlb]" > </label> <label class="fd-type fd-mc"> Medicare Card: <input type="file" name="doc_auth[docs][%NAME%][mc]" > </label> <label class="fd-type fd-kp" style="display:none;" > Key Pass: <input type="file" name="doc_auth[docs][%NAME%][kp]" > </label> <label class="fd-type fd-ub" style="display:none;" > Utility Bill: <input type="file" name="doc_auth[docs][%NAME%][ub]" > </label> <label class="fd-type fd-pp" style="display:none;" > Passport: <input type="file" name="doc_auth[docs][%NAME%][pp]" > </label> </div> </div>',t=$("#FinanceForm").serializeObject();$("#doc-select").html("");for(let a of t.business_details.owners)if(null!=a&&""!=a.name&&""!=a.position){let t=e.replace(/%NAME%/g,a.name).replace(/%NAME_SP%/g,a.name.replace(/\s/g,""));$("#doc-select").append(t)}}function s(e){let t=[],a=!0;$(".fNotice").remove(),$(".inValid").removeClass("inValid");let s='<span class="fNotice">msg</span>';switch(e){case"applicant_details":t.push({name:"applicant_details[full_name]",type:"text",msg:"Please enter full name"}),t.push({name:"applicant_details[phone]",type:"text",msg:"Please enter phone"}),t.push({name:"applicant_details[email]",type:"text",msg:"Please enter email"}),t.push({name:"applicant_details[state]",type:"select",msg:"Please select state"}),t.push({name:"applicant_details[hospo_experience]",type:"select",msg:"Please select option"});break;case"business_details":t.push({name:"business_details[business_name]",type:"text",msg:"Please enter business name"}),t.push({name:"business_details[abn]",type:"text",msg:"Please enter ABN"}),t.push({name:"business_details[business_type]",type:"select",msg:"Please select business type"}),t.push({name:"business_details[about]",type:"textarea",msg:"Please tell us about your business"}),t.push({name:"business_details[operating_status]",type:"select",msg:"Please select option"}),$(".ff-owner").each((function(){let e=$(this).find(".ff-owner-name"),t=$(this).find(".ff-owner-pos");""==e.val()&&(e.addClass("inValid"),a=!1),""==t.val()&&(t.addClass("inValid"),a=!1)}));break;case"financial-details":t.push({name:"financial_details[seeking_amount]",type:"select",msg:"Please select option"}),t.push({name:"financial_details[creditor_funding]",type:"radio",msg:"Please select option"}),t.push({name:"financial_details[cashflow_forecast]",type:"radio",msg:"Please select option"}),t.push({name:"financial_details[tax_return]",type:"radio",msg:"Please select option"}),t.push({name:"financial_details[lease]",type:"radio",msg:"Please select option"}),t.push({name:"financial_details[insurance]",type:"radio",msg:"Please select option"}),console.log(t);break;case"documentation-authorisation":$(".doc-group").each((function(){let e=$(this).find(".docs-type").val().split("_");for(dT of e){let e=$(this).find(".fd-"+dT+" input");e[0].files.length<1?(e.addClass("inValid"),e.append(s.replace("msg","Please choose document")),a=!1):e.removeClass("inValid")}}))}for(vF of t)if("text"==vF.type){let e=document.querySelector('input[name="'+vF.name+'"]');(null==e||e.value.length<1)&&(a=!1,e.classList.add("inValid"),e.insertAdjacentHTML("afterend",s.replace("msg",vF.msg)))}else if("textarea"==vF.type){let e=document.querySelector('textarea[name="'+vF.name+'"]');(null==e||e.value.length<1)&&(a=!1,e.classList.add("inValid"),e.insertAdjacentHTML("afterend",s.replace("msg",vF.msg)))}else if("select"==vF.type){let e=document.querySelector('select[name="'+vF.name+'"]');(null==e||e.value.length<1)&&(a=!1,e.classList.add("inValid"),e.insertAdjacentHTML("afterend",s.replace("msg",vF.msg)))}else if("radio"==vF.type){let e=document.querySelector('input[name="'+vF.name+'"]:checked');(null==e||e.value.length<1)&&(a=!1,e=document.querySelector('input[name="'+vF.name+'"]'),e.parentElement.parentElement.classList.add("inValid"),e.parentElement.parentElement.insertAdjacentHTML("beforeend",s.replace("msg",vF.msg)))}return a}!function(e){e.fn.serializeObject=function(){var t=this,a={},s={},i={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,t,a){return e[t]=a,e},this.push_counter=function(e){return void 0===s[e]&&(s[e]=0),s[e]++},e.each(e(this).serializeArray(),(function(){if(i.validate.test(this.name)){for(var s,n=this.name.match(i.key),l=this.value.replace(/(?:\r\n|\r|\n)/g," ").replace(/"/g,"'"),c=this.name;void 0!==(s=n.pop());)c=c.replace(new RegExp("\\["+s+"\\]$"),""),s.match(i.push)?l=t.build([],t.push_counter(c),l):s.match(i.fixed)?l=t.build([],s,l):s.match(i.named)&&(l=t.build({},s,l));a=e.extend(!0,a,l)}})),a}}(jQuery),a(),$(".ff-input").keyup((function(){if($(this).hasClass("inValid")){s($("#FinanceForm").attr("data-step"))}})),$(".ff-input").change((function(){if($(this).hasClass("inValid")){s($("#FinanceForm").attr("data-step"))}})),$("#ff-add-owner").click((function(){let e=parseInt($("#owner-count").val())+1;$("#owner-count").val(e);let t=`<div class="ff-owner" id="owner${e}"><input type="text" class="ff-input ff-owner-name" name="business_details[owners][${e}][name]" placeholder="Full Name *" required /><input type="text" class="ff-input ff-owner-pos" name="business_details[owners][${e}][position]"   placeholder="Position *" required /><button type="button" onclick="ffRemoveOwner(${e})">-</button></div>`;$("#ff-owner-holder").append(t)})),$("#ff-next").click((function(){let i=$("#FinanceForm").attr("data-step");if(s(i)){switch(i){case"required-documents":$("#ff-back").removeAttr("disabled"),$("#ff-next").text("Save & Continue"),$(".fp-marker").css("width","calc((100% / 7) * 2)"),$(".fp-msg").text("Step 2 of 7"),$("#current-step").val("2"),e("applicant_details");break;case"applicant_details":$(".fp-marker").css("width","calc((100% / 7) * 3)"),$(".fp-msg").text("Step 3 of 7"),$("#current-step").val("3"),e("business_details");break;case"business_details":$(".fp-marker").css("width","calc((100% / 7) * 4)"),$(".fp-msg").text("Step 4 of 7"),$("#current-step").val("4"),e("financial-details");break;case"financial-details":$(".fp-marker").css("width","calc((100% / 7) * 5)"),$(".fp-msg").text("Step 5 of 7"),$("#current-step").val("5"),e("social-media");break;case"social-media":$(".fp-marker").css("width","calc((100% / 7) * 6)"),$(".fp-msg").text("Step 6 of 7"),$("#current-step").val("6"),e("documentation-authorisation"),a();break;case"documentation-authorisation":$(".fp-marker").css("width","calc((100% / 7) * 7)"),$(".fp-msg").text("Step 7 of 7"),$("#current-step").val("6"),e("confirm-application"),$(".form-actions").hide(),function(){let e=$("#FinanceForm").serializeObject(),t="";$("#doc-review").html("");for(const[a,s]of Object.entries(e)){t+=`<h3>${a.replace(/_/g," ")}</h3>`;for(const[e,a]of Object.entries(s))if(Array.isArray(a))for(val of(t+=`<p><strong>${e}:</strong></p>`,a))null!=val&&(t+=`<p style="margin-left: 10px;">${val.name} | ${val.position}</p>`);else t+=`<p><i>${e.replace(/_/g," ")}:</i> ${a}</p>`}t+='<p><i>Your attached documents will be uploaded when you press "Submit Application"</i></p>',$("#doc-review").html(t)}();break;case"confirm-application":$("#current-step").val("6");break;default:console.log("NO STEP FOUND")}t()}else console.log("form invalid")})),$("#ff-back").click((function(){switch($("#FinanceForm").attr("data-step")){case"applicant_details":$("#ff-back").attr("disabled","disabled"),$(".fp-marker").css("width","calc((100% / 7) * 1)"),$(".fp-msg").text("Step 1 of 7"),$("#current-step").val("1"),e("required-documents");break;case"business_details":document.getElementById("ff-next").removeAttribute("disabled"),$(".fp-marker").css("width","calc((100% / 7) * 2)"),$(".fp-msg").text("Step 2 of 7"),$("#current-step").val("2"),e("applicant_details");break;case"financial-details":$(".fp-marker").css("width","calc((100% / 7) * 3)"),$(".fp-msg").text("Step 3 of 7"),$("#current-step").val("3"),e("business_details");break;case"social-media":$(".fp-marker").css("width","calc((100% / 7) * 4)"),$(".fp-msg").text("Step 4 of 7"),$("#current-step").val("4"),e("financial-details");break;case"documentation-authorisation":$(".fp-marker").css("width","calc((100% / 7) * 5)"),$(".fp-msg").text("Step 5 of 7"),$("#current-step").val("5"),e("social-media");break;case"confirm-application":$(".fp-marker").css("width","calc((100% / 7) * 6)"),$(".fp-msg").text("Step 6 of 7"),$("#current-step").val("6"),e("documentation-authorisation"),$("#ff-next").text("Save & Continue");break;default:console.log("NO BACK STEP FOUND")}t()})),$("#ff-back2").click((function(){$(".fp-marker").css("width","calc((100% / 7) * 5)"),$(".fp-msg").text("Step 6 of 7"),e("documentation-authorisation"),$(".form-actions").show(),$("#FormDeclare").prop("checked",!1),$("#ff-submit").attr("disabled","disabled"),$("#ff-next").text("Save & Continue")})),$("#FormDeclare").change((function(){this.checked?$("#ff-submit").removeAttr("disabled"):$("#ff-submit").attr("disabled","disabled")})),$("#SubmitApplication").submit((function(){$("#ff-submit").attr("disabled","disabled")}))}};